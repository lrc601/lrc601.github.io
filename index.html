<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>位置二维码生成器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/qrcode.js@1.0.0/qrcode.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36D399',
                        neutral: '#3D4451',
                        "neutral-content": '#F2F7FF',
                        "base-100": '#FFFFFF',
                        "base-200": '#F9FAFB',
                        "base-300": '#F2F2F2',
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.03)',
                        'card-hover': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                    }
                },
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            }
            .transition-custom {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }
            .map-height {
                height: clamp(300px, 50vh, 500px);
            }
        }
    </style>
</head>
<body class="font-inter bg-base-200 min-h-screen flex flex-col">
    <!-- 导航栏 -->
    <header class="bg-white shadow-md sticky top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa fa-map-marker text-primary text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold text-neutral">位置二维码生成器</h1>
            </div>
            <nav>
                <ul class="hidden md:flex space-x-8">
                    <li><a href="#" class="text-neutral hover:text-primary transition-colors duration-300">首页</a></li>
                    <li><a href="#" class="text-neutral hover:text-primary transition-colors duration-300">使用指南</a></li>
                    <li><a href="#" class="text-neutral hover:text-primary transition-colors duration-300">关于我们</a></li>
                </ul>
                <button class="md:hidden text-neutral text-xl">
                    <i class="fa fa-bars"></i>
                </button>
            </nav>
        </div>
    </header>

    <!-- 主要内容 -->
    <main class="flex-grow container mx-auto px-4 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- 左侧面板：位置选择 -->
            <div class="lg:col-span-2 space-y-6">
                <div class="bg-white rounded-xl shadow-card p-6 transition-custom hover:shadow-card-hover">
                    <h2 class="text-xl font-bold text-neutral mb-4 flex items-center">
                        <i class="fa fa-map-o text-primary mr-2"></i>选择位置
                    </h2>
                    <div class="space-y-4">
                        <div class="flex flex-col md:flex-row gap-4">
                            <div class="flex-1">
                                <label for="address" class="block text-sm font-medium text-neutral mb-1">地址搜索</label>
                                <div class="relative">
                                    <input type="text" id="address" placeholder="输入地址搜索..." 
                                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-custom">
                                    <button id="searchBtn" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-primary hover:text-primary/80 transition-colors">
                                        <i class="fa fa-search"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="flex items-end">
                                <button id="useCurrentLocation" class="bg-primary hover:bg-primary/90 text-white px-4 py-2 rounded-lg transition-custom flex items-center">
                                    <i class="fa fa-location-arrow mr-2"></i>使用当前位置
                                </button>
                            </div>
                        </div>
                        
                        <div class="map-height rounded-lg border border-gray-200 overflow-hidden">
                            <div id="map" class="w-full h-full"></div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label for="latitude" class="block text-sm font-medium text-neutral mb-1">纬度</label>
                                <input type="text" id="latitude" readonly 
                                    class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg">
                            </div>
                            <div>
                                <label for="longitude" class="block text-sm font-medium text-neutral mb-1">经度</label>
                                <input type="text" id="longitude" readonly 
                                    class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg">
                            </div>
                        </div>
                        
                        <div>
                            <label for="locationName" class="block text-sm font-medium text-neutral mb-1">位置名称 (可选)</label>
                            <input type="text" id="locationName" placeholder="输入位置名称" 
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-custom">
                        </div>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-card p-6 transition-custom hover:shadow-card-hover">
                    <h2 class="text-xl font-bold text-neutral mb-4 flex items-center">
                        <i class="fa fa-info-circle text-primary mr-2"></i>二维码信息
                    </h2>
                    <div class="space-y-4">
                        <div>
                            <label for="qrCodeSize" class="block text-sm font-medium text-neutral mb-1">二维码大小</label>
                            <div class="flex items-center space-x-4">
                                <input type="range" id="qrCodeSize" min="128" max="512" step="32" value="256" 
                                    class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary">
                                <span id="qrCodeSizeValue" class="text-sm font-medium text-neutral min-w-[40px] text-center">256px</span>
                            </div>
                        </div>
                        
                        <div>
                            <label for="qrCodeColor" class="block text-sm font-medium text-neutral mb-1">二维码颜色</label>
                            <input type="color" id="qrCodeColor" value="#000000" 
                                class="w-12 h-12 border border-gray-300 rounded-lg cursor-pointer">
                        </div>
                        
                        <div>
                            <label for="qrCodeBgColor" class="block text-sm font-medium text-neutral mb-1">背景颜色</label>
                            <input type="color" id="qrCodeBgColor" value="#FFFFFF" 
                                class="w-12 h-12 border border-gray-300 rounded-lg cursor-pointer">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 右侧面板：二维码预览与操作 -->
            <div class="lg:col-span-1 space-y-6">
                <div class="bg-white rounded-xl shadow-card p-6 transition-custom hover:shadow-card-hover h-full flex flex-col">
                    <h2 class="text-xl font-bold text-neutral mb-4 flex items-center">
                        <i class="fa fa-qrcode text-primary mr-2"></i>二维码预览
                    </h2>
                    
                    <div class="flex-grow flex flex-col items-center justify-center p-4">
                        <div id="qrcodeContainer" class="w-64 h-64 flex items-center justify-center bg-gray-100 rounded-lg mb-4 transition-custom">
                            <div id="qrcode" class="w-full h-full flex items-center justify-center">
                                <div class="text-center text-gray-400">
                                    <i class="fa fa-map-marker text-4xl mb-2"></i>
                                    <p class="text-sm">选择位置生成二维码</p>
                                </div>
                            </div>
                        </div>
                        
                        <div id="qrCodeUrlContainer" class="hidden w-full mb-4">
                            <div class="relative">
                                <input type="text" id="qrCodeUrl" readonly 
                                    class="w-full px-4 py-2 bg-gray-50 border border-gray-300 rounded-lg pr-10 text-sm truncate">
                                <button id="copyUrlBtn" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-primary hover:text-primary/80 transition-colors text-sm">
                                    <i class="fa fa-copy"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 space-y-3">
                        <button id="generateBtn" class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-3 px-4 rounded-lg transition-custom flex items-center justify-center">
                            <i class="fa fa-refresh mr-2"></i>生成二维码
                        </button>
                        
                        <button id="downloadBtn" class="w-full bg-secondary hover:bg-secondary/90 text-white font-medium py-3 px-4 rounded-lg transition-custom flex items-center justify-center opacity-50 cursor-not-allowed" disabled>
                            <i class="fa fa-download mr-2"></i>下载二维码
                        </button>
                        
                        <button id="shareBtn" class="w-full bg-white border border-primary text-primary hover:bg-primary/5 font-medium py-3 px-4 rounded-lg transition-custom flex items-center justify-center opacity-50 cursor-not-allowed" disabled>
                            <i class="fa fa-share-alt mr-2"></i>分享二维码
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-neutral text-neutral-content py-6">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <p class="text-sm">&copy; 2025 位置二维码生成器. 保留所有权利.</p>
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="text-neutral-content hover:text-primary transition-colors">
                        <i class="fa fa-github text-xl"></i>
                    </a>
                    <a href="#" class="text-neutral-content hover:text-primary transition-colors">
                        <i class="fa fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-neutral-content hover:text-primary transition-colors">
                        <i class="fa fa-linkedin text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- 通知提示 -->
    <div id="notification" class="fixed bottom-4 right-4 bg-white shadow-lg rounded-lg p-4 transform translate-y-20 opacity-0 transition-all duration-300 z-50 max-w-sm">
        <div class="flex items-start">
            <div id="notificationIcon" class="mr-3 text-green-500">
                <i class="fa fa-check-circle text-xl"></i>
            </div>
            <div>
                <h3 id="notificationTitle" class="font-medium text-neutral">操作成功</h3>
                <p id="notificationMessage" class="text-sm text-gray-600 mt-1">二维码已生成</p>
            </div>
            <button id="closeNotification" class="ml-auto text-gray-400 hover:text-gray-600">
                <i class="fa fa-times"></i>
            </button>
        </div>
    </div>

    <script>
        // 初始化地图
        const map = L.map('map').setView([39.9042, 116.4074], 13); // 默认位置：北京
        
        // 添加OpenStreetMap图层
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // 添加标记
        let marker = L.marker([39.9042, 116.4074]).addTo(map);
        
        // 更新标记位置和输入框
        function updateMarkerAndInputs(lat, lng) {
            marker.setLatLng([lat, lng]);
            document.getElementById('latitude').value = lat.toFixed(6);
            document.getElementById('longitude').value = lng.toFixed(6);
            map.panTo([lat, lng]);
        }
        
        // 点击地图更新位置
        map.on('click', function(e) {
            updateMarkerAndInputs(e.latlng.lat, e.latlng.lng);
        });
        
        // 初始化二维码生成器
        function generateQRCode() {
            const lat = parseFloat(document.getElementById('latitude').value);
            const lng = parseFloat(document.getElementById('longitude').value);
            const locationName = document.getElementById('locationName').value;
            const size = parseInt(document.getElementById('qrCodeSize').value);
            const color = document.getElementById('qrCodeColor').value;
            const bgColor = document.getElementById('qrCodeBgColor').value;
            
            // 验证经纬度
            if (isNaN(lat) || isNaN(lng)) {
                showNotification('错误', '请选择有效的位置', 'error');
                return;
            }
            
            // 构建位置URL
            let locationUrl = `https://maps.google.com/maps?q=${lat},${lng}`;
            if (locationName) {
                locationUrl += `&name=${encodeURIComponent(locationName)}`;
            }
            
            // 显示URL
            document.getElementById('qrCodeUrl').value = locationUrl;
            document.getElementById('qrCodeUrlContainer').classList.remove('hidden');
            
            // 清空现有二维码
            document.getElementById('qrcode').innerHTML = '';
            
            // 生成新二维码
            new QRCode(document.getElementById('qrcode'), {
                text: locationUrl,
                width: size,
                height: size,
                colorDark: color,
                colorLight: bgColor,
                correctLevel: QRCode.CorrectLevel.H
            });
            
            // 启用下载和分享按钮
            document.getElementById('downloadBtn').classList.remove('opacity-50', 'cursor-not-allowed');
            document.getElementById('downloadBtn').disabled = false;
            document.getElementById('shareBtn').classList.remove('opacity-50', 'cursor-not-allowed');
            document.getElementById('shareBtn').disabled = false;
            
            showNotification('成功', '二维码已生成', 'success');
        }
        
        // 显示通知
        function showNotification(title, message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationTitle = document.getElementById('notificationTitle');
            const notificationMessage = document.getElementById('notificationMessage');
            const notificationIcon = document.getElementById('notificationIcon');
            
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            
            // 设置图标和颜色
            if (type === 'success') {
                notificationIcon.className = 'mr-3 text-green-500';
                notificationIcon.innerHTML = '<i class="fa fa-check-circle text-xl"></i>';
            } else if (type === 'error') {
                notificationIcon.className = 'mr-3 text-red-500';
                notificationIcon.innerHTML = '<i class="fa fa-exclamation-circle text-xl"></i>';
            } else if (type === 'warning') {
                notificationIcon.className = 'mr-3 text-yellow-500';
                notificationIcon.innerHTML = '<i class="fa fa-exclamation-triangle text-xl"></i>';
            }
            
            // 显示通知
            notification.classList.remove('translate-y-20', 'opacity-0');
            
            // 3秒后自动关闭
            setTimeout(() => {
                closeNotification();
            }, 3000);
        }
        
        // 关闭通知
        function closeNotification() {
            const notification = document.getElementById('notification');
            notification.classList.add('translate-y-20', 'opacity-0');
        }
        
        // 下载二维码
        function downloadQRCode() {
            const canvas = document.querySelector('#qrcode canvas');
            if (!canvas) {
                showNotification('错误', '没有可下载的二维码', 'error');
                return;
            }
            
            // 创建下载链接
            const link = document.createElement('a');
            link.download = `location-qrcode-${new Date().getTime()}.png`;
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            showNotification('成功', '二维码已下载', 'success');
        }
        
        // 复制URL
        function copyUrl() {
            const urlInput = document.getElementById('qrCodeUrl');
            urlInput.select();
            document.execCommand('copy');
            
            showNotification('成功', 'URL已复制到剪贴板', 'success');
        }
        
        // 分享功能
        function shareQRCode() {
            if (navigator.share) {
                const url = document.getElementById('qrCodeUrl').value;
                const locationName = document.getElementById('locationName').value || '位置';
                
                navigator.share({
                    title: `分享${locationName}位置`,
                    text: `查看${locationName}的位置：${url}`,
                    url: url
                })
                .then(() => showNotification('成功', '已分享位置', 'success'))
                .catch(error => showNotification('错误', '分享失败: ' + error, 'error'));
            } else {
                showNotification('错误', '您的浏览器不支持分享功能', 'error');
            }
        }
        
        // 使用当前位置
        function useCurrentLocation() {
            if (navigator.geolocation) {
                showNotification('提示', '正在获取您的位置...', 'warning');
                
                navigator.geolocation.getCurrentPosition(
                    position => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        updateMarkerAndInputs(lat, lng);
                        showNotification('成功', '已获取您的当前位置', 'success');
                    },
                    error => {
                        switch (error.code) {
                            case error.PERMISSION_DENIED:
                                showNotification('错误', '请允许位置访问权限', 'error');
                                break;
                            case error.POSITION_UNAVAILABLE:
                                showNotification('错误', '位置信息不可用', 'error');
                                break;
                            case error.TIMEOUT:
                                showNotification('错误', '获取位置超时', 'error');
                                break;
                            case error.UNKNOWN_ERROR:
                                showNotification('错误', '发生未知错误', 'error');
                                break;
                        }
                    }
                );
            } else {
                showNotification('错误', '您的浏览器不支持地理位置服务', 'error');
            }
        }
        
        // 地址搜索功能（模拟）
        function searchAddress() {
            const address = document.getElementById('address').value;
            if (!address) {
                showNotification('提示', '请输入要搜索的地址', 'warning');
                return;
            }
            
            // 模拟搜索延迟
            showNotification('提示', '正在搜索地址...', 'warning');
            setTimeout(() => {
                // 模拟搜索结果（随机位置）
                const lat = 39.9042 + (Math.random() - 0.5) * 0.1;
                const lng = 116.4074 + (Math.random() - 0.5) * 0.1;
                updateMarkerAndInputs(lat, lng);
                showNotification('成功', `已找到地址: ${address}`, 'success');
            }, 1000);
        }
        
        // 二维码大小滑块更新
        document.getElementById('qrCodeSize').addEventListener('input', function(e) {
            document.getElementById('qrCodeSizeValue').textContent = `${e.target.value}px`;
        });
        
        // 事件监听
        document.getElementById('generateBtn').addEventListener('click', generateQRCode);
        document.getElementById('downloadBtn').addEventListener('click', downloadQRCode);
        document.getElementById('copyUrlBtn').addEventListener('click', copyUrl);
        document.getElementById('shareBtn').addEventListener('click', shareQRCode);
        document.getElementById('useCurrentLocation').addEventListener('click', useCurrentLocation);
        document.getElementById('searchBtn').addEventListener('click', searchAddress);
        document.getElementById('closeNotification').addEventListener('click', closeNotification);
        
        // 回车键触发搜索
        document.getElementById('address').addEventListener('keyup', function(e) {
            if (e.key === 'Enter') {
                searchAddress();
            }
        });
        
        // 页面加载完成后初始化
        window.addEventListener('load', function() {
            // 初始生成一个默认位置的二维码
            generateQRCode();
            
            // 导航栏滚动效果
            window.addEventListener('scroll', function() {
                const header = document.querySelector('header');
                if (window.scrollY > 10) {
                    header.classList.add('py-2');
                    header.classList.remove('py-4');
                } else {
                    header.classList.add('py-4');
                    header.classList.remove('py-2');
                }
            });
        });
    </script>
</body>
</html>
    
